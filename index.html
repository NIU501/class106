<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>1í•™ë…„ 6ë°˜ ìë¦¬ í‹°ì¼“íŒ…</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Inter Font -->
    <style>
        .font-inter { font-family: 'Inter', sans-serif; }
    </style>
    <!-- React & Babel CDN -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Lucide Icons CDN -->
    <script src="https://unpkg.com/lucide-react@latest/dist/umd/lucide-react.js"></script>
    <!-- Firebase CDN -->
    <script src="https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        // Firebase Auth ë° Firestore ëª¨ë“ˆì„ ì „ì—­ ë³€ìˆ˜ì—ì„œ ê°€ì ¸ì˜µë‹ˆë‹¤.
        const { initializeApp } = firebase;
        const { getAuth, signInAnonymously } = firebase.auth;
        const { getFirestore, doc, setDoc, onSnapshot } = firebase.firestore;
        
        // Lucide React ì»´í¬ë„ŒíŠ¸ë“¤ì„ ì „ì—­ ë³€ìˆ˜ì—ì„œ ê°€ì ¸ì˜µë‹ˆë‹¤.
        const { Users, Check, User, Shield, ShieldOff, Loader2, RotateCcw } = lucide;

        // --- 1ë‹¨ê³„: ì‚¬ìš©ìë‹˜ì˜ Firebase ì„¤ì •ìœ¼ë¡œ êµì²´í•˜ì„¸ìš”! ---
        // ì´ ë¶€ë¶„ì„ ì‚¬ìš©ìë‹˜ì˜ ì‹¤ì œ Firebase ì½˜ì†” ì •ë³´ë¡œ ë°˜ë“œì‹œ êµì²´í•´ì•¼ í•©ë‹ˆë‹¤.
        const firebaseConfig = {
            apiKey: "[YOUR_API_KEY_HERE]", 
            authDomain: "[YOUR_AUTH_DOMAIN_HERE]",
            projectId: "[YOUR_PROJECT_ID_HERE]", // ì‹¤ì œ í”„ë¡œì íŠ¸ IDë¡œ êµì²´í•˜ì„¸ìš”.
            storageBucket: "[YOUR_STORAGE_BUCKET_HERE]",
            messagingSenderId: "[YOUR_MESSAGING_SENDER_ID_HERE]",
            appId: "[YOUR_FIREBASE_APP_ID_HERE]" // ì‹¤ì œ ì•± IDë¡œ êµì²´í•˜ì„¸ìš”.
        };
        // ìº”ë²„ìŠ¤ í™˜ê²½ì—ì„œ ì‚¬ìš©ë˜ë˜ __app_id ë³€ìˆ˜ëŠ” ì´ì œ Firebase project IDë¥¼ ê¸°ë°˜ìœ¼ë¡œ ëŒ€ì²´ë©ë‹ˆë‹¤.
        const YOUR_PROJECT_ID = firebaseConfig.projectId;
        // ----------------------------------------------------

        const { useState, useEffect, useCallback } = React;

        // ì´ˆê¸° ìë¦¬ ìƒíƒœ ì •ì˜
        const initialSeats = {
            section1: Array(8).fill(null),
            section2: Array(8).fill(null),
            section3: Array(9).fill(null),
            section4: Array(6).fill(null)
        };
        const INITIAL_STATE = {
            seats: initialSeats,
            isStarted: false,
        };
        const TOTAL_SEATS = 31;


        /**
         * Custom Notification Component to replace window.alert()
         */
        const NotificationBar = ({ notification, setNotification }) => {
          useEffect(() => {
            if (notification.content) {
              const timer = setTimeout(() => {
                setNotification({ content: '', type: null });
              }, 3000);
              return () => clearTimeout(timer);
            }
          }, [notification, setNotification]);

          if (!notification.content) return null;

          const baseClasses = "fixed top-4 left-1/2 transform -translate-x-1/2 p-4 rounded-xl shadow-2xl z-50 text-white font-semibold transition-opacity duration-300";
          const typeClasses = notification.type === 'error'
            ? 'bg-red-500'
            : 'bg-green-500';

          return (
            <div className={`${baseClasses} ${typeClasses}`}>
              {notification.content}
            </div>
          );
        };

        // --- ë©”ì¸ ì»´í¬ë„ŒíŠ¸ ì‹œì‘ ---
        function ClassroomSeatingApp() {
          // --- Firebase States ---
          const [db, setDb] = useState(null);
          const [userId, setUserId] = useState(null);
          const [isLoading, setIsLoading] = useState(true); // ì´ˆê¸° ë°ì´í„° ë¡œë”© ìƒíƒœ

          // --- App States (Firestoreì—ì„œ ë™ê¸°í™”ë¨) ---
          const [seats, setSeats] = useState(initialSeats);
          const [isStarted, setIsStarted] = useState(false); // í‹°ì¼“íŒ… ì‹œì‘ ì—¬ë¶€

          // --- Local States ---
          const [studentName, setStudentName] = useState('');
          const [selectedSeat, setSelectedSeat] = useState(null);
          const [isAdminMode, setIsAdminMode] = useState(false);
          const [showPasswordInput, setShowPasswordInput] = useState(false);
          const [passwordInput, setPasswordInput] = useState('');
          const [cancelTarget, setCancelTarget] = useState(null); // ì·¨ì†Œ í™•ì¸ì°½ í‘œì‹œìš©
          const [notification, setNotification] = useState({ content: '', type: null });
          const [showResetConfirm, setShowResetConfirm] = useState(false); // ì´ˆê¸°í™” í™•ì¸ì°½

          // Helper function to display temporary notification
          const showNotification = useCallback((content, type) => {
            setNotification({ content, type });
          }, []);

          // Firestore ë°ì´í„° ì“°ê¸° í•¨ìˆ˜ (í†µí•©)
          const updateClassroomState = useCallback(async (updates) => {
            if (!db || isLoading) {
              showNotification('ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ëŒ€ê¸° ì¤‘ì´ê±°ë‚˜ ë¡œë”© ì¤‘ì…ë‹ˆë‹¤.', 'error');
              return;
            }
            
            // ë°ì´í„° ê²½ë¡œ: /seats/classroom-state (ê³µê°œ ë°ì´í„°ë¡œ ë‹¨ìˆœí™”)
            // GitHub ë°°í¬ í™˜ê²½ì—ì„œëŠ” /artifacts/{appId}/public/data ê²½ë¡œë¥¼ ì‚¬ìš©í•  í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤.
            const docRef = doc(db, 'seats', 'classroom-state'); 
            try {
              await setDoc(docRef, updates, { merge: true });
              // ë¡œì»¬ ìƒíƒœ ì—…ë°ì´íŠ¸ëŠ” onSnapshot ë¦¬ìŠ¤ë„ˆë¥¼ í†µí•´ ìë™ìœ¼ë¡œ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤.
            } catch (error) {
              console.error("Error updating classroom state in Firestore:", error);
              showNotification('ë°ì´í„° ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. (Firestore ì—ëŸ¬)', 'error');
            }
          }, [db, isLoading, showNotification]);

          // --- Firebase ì´ˆê¸°í™” ë° ì‹¤ì‹œê°„ ë¦¬ìŠ¤ë„ˆ ì„¤ì • ---
          useEffect(() => {
            if (!firebaseConfig.apiKey === '[YOUR_API_KEY_HERE]') {
                console.error("Firebase configuration is missing or placeholder.");
                showNotification("Firebase ì„¤ì •ì„ ë¨¼ì € êµì²´í•´ì£¼ì„¸ìš”!", "error");
                return;
            }
            
            try {
              const app = initializeApp(firebaseConfig);
              const dbInstance = getFirestore(app);
              const authInstance = getAuth(app);

              setDb(dbInstance);

              const authenticateAndListen = async () => {
                try {
                  // GitHub í™˜ê²½ì—ì„œëŠ” í”Œë«í¼ í† í°ì´ ì—†ìœ¼ë¯€ë¡œ ìµëª… ë¡œê·¸ì¸ë§Œ ì‹œë„í•©ë‹ˆë‹¤.
                  await signInAnonymously(authInstance);
                  
                  const currentUserId = authInstance.currentUser?.uid || crypto.randomUUID();
                  setUserId(currentUserId);

                  // Firestore ë¦¬ìŠ¤ë„ˆ ì„¤ì •: 'seats' ì»¬ë ‰ì…˜ì˜ 'classroom-state' ë¬¸ì„œ ì‚¬ìš©
                  const docRef = doc(dbInstance, 'seats', 'classroom-state');

                  const unsubscribe = onSnapshot(docRef, (docSnap) => {
                    if (docSnap.exists()) {
                      const data = docSnap.data();
                      // Firestore ë°ì´í„°ë¡œ ë¡œì»¬ ìƒíƒœ ë™ê¸°í™”
                      setSeats(data.seats || initialSeats);
                      setIsStarted(data.isStarted || false);
                    } else {
                      // ë¬¸ì„œê°€ ì—†ìœ¼ë©´ ì´ˆê¸° ìƒíƒœë¡œ ìƒì„± (ì²« ì‚¬ìš©ì)
                      setDoc(docRef, INITIAL_STATE)
                        .then(() => console.log("Initial state created."))
                        .catch(error => console.error("Error creating initial state:", error));
                      setSeats(initialSeats);
                      setIsStarted(false);
                    }
                    setIsLoading(false); // ì´ˆê¸° ë¡œë”© ì™„ë£Œ
                  }, (error) => {
                    console.error("Firestore real-time listener failed:", error);
                    showNotification("ì‹¤ì‹œê°„ ì—°ê²°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.", "error");
                    setIsLoading(false);
                  });

                  return unsubscribe;
                } catch (error) {
                  console.error("Firebase authentication failed:", error);
                  showNotification("ì¸ì¦ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. (Firebase)", "error");
                  setIsLoading(false);
                }
              };

              const unsubscribe = authenticateAndListen();
              return () => {
                if (unsubscribe && typeof unsubscribe === 'function') {
                  unsubscribe();
                }
              };

            } catch (e) {
              console.error("Firebase initialization failed:", e);
              setIsLoading(false);
            }
          }, []);

          // --- App Logic Functions (Uses updateClassroomState) ---

          const toggleAdminMode = () => {
            if (!isAdminMode) {
              setShowPasswordInput(true);
            } else {
              setIsAdminMode(false);
              setShowPasswordInput(false);
              setPasswordInput('');
              showNotification('ê´€ë¦¬ì ëª¨ë“œê°€ í•´ì œë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
            }
          };

          const checkPassword = () => {
            if (passwordInput === '1234') {
              setIsAdminMode(true);
              setShowPasswordInput(false);
              setPasswordInput('');
              showNotification('ê´€ë¦¬ì ëª¨ë“œê°€ í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
            } else {
              showNotification('ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.', 'error');
              setPasswordInput('');
            }
          };

          const handleSeatSelect = (section, index) => {
            if (!isStarted && !isAdminMode) return; // ì‹œì‘ ì „ì—ëŠ” ê´€ë¦¬ìë§Œ ì„ íƒ ê°€ëŠ¥
            
            if (seats[section][index] !== null) {
              // ì´ë¯¸ ì°¨ìˆëŠ” ìë¦¬ - ê´€ë¦¬ìë§Œ ì·¨ì†Œ ê°€ëŠ¥
              if (isAdminMode) {
                setCancelTarget({ section, index, name: seats[section][index] });
              }
              return;
            }
            // ë¹ˆ ìë¦¬ ì„ íƒ
            setSelectedSeat({ section, index });
          };

          const confirmCancel = () => {
            if (cancelTarget) {
              const name = cancelTarget.name;
              const newSeats = { ...seats };
              newSeats[cancelTarget.section][cancelTarget.index] = null;
              
              updateClassroomState({ seats: newSeats }); // Firestoreì— ì—…ë°ì´íŠ¸
              
              setCancelTarget(null);
              showNotification(`${name}ë‹˜ì˜ ìë¦¬ê°€ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.`, 'success');
            }
          };

          const cancelCancel = () => {
            setCancelTarget(null);
          };

          const toggleSeatingStart = () => {
            if (!isAdminMode) return;
            const newState = !isStarted;
            updateClassroomState({ isStarted: newState }); // Firestoreì— ì—…ë°ì´íŠ¸
            showNotification(newState ? 'í‹°ì¼“íŒ…ì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤!' : 'í‹°ì¼“íŒ…ì´ ì¤‘ì§€ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
          };
          
          // ìƒˆë¡œ ì¶”ê°€ëœ ì´ˆê¸°í™” ë¡œì§
          const resetData = () => {
            if (!isAdminMode) return;
            setShowResetConfirm(true);
          };
          
          const confirmReset = () => {
              // ëª¨ë“  ìë¦¬ ì´ˆê¸°í™” ë° isStarted ìƒíƒœ falseë¡œ ì—…ë°ì´íŠ¸
              updateClassroomState(INITIAL_STATE);
              setShowResetConfirm(false);
              showNotification('ëª¨ë“  ìë¦¬ ë°°ì • ë°ì´í„°ê°€ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
          };

          const cancelReset = () => {
              setShowResetConfirm(false);
          };

          const confirmSeat = () => {
            if (!isStarted) {
              showNotification('ì•„ì§ í‹°ì¼“íŒ…ì´ ì‹œì‘ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤!', 'error');
              return;
            }
            if (!studentName.trim()) {
              showNotification('í•™ìƒ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!', 'error');
              return;
            }
            if (!selectedSeat) {
              showNotification('ìë¦¬ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”!', 'error');
              return;
            }
            
            // ë‹¤ì¤‘ ì‚¬ìš©ì í™˜ê²½ì—ì„œ ìµœì¢… í™•ì¸ (ìë¦¬ ì„ ì  ë°©ì§€)
            if (seats[selectedSeat.section][selectedSeat.index] !== null) {
              showNotification('ì£„ì†¡í•©ë‹ˆë‹¤. ì„ íƒí•œ ìë¦¬ê°€ ë°©ê¸ˆ ë‹¤ë¥¸ ì‚¬ëŒì— ì˜í•´ ë°°ì •ë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì„ íƒí•´ì£¼ì„¸ìš”.', 'error');
              setSelectedSeat(null);
              return;
            }

            const newSeats = { ...seats };
            newSeats[selectedSeat.section][selectedSeat.index] = studentName.trim();
            
            updateClassroomState({ seats: newSeats }); // Firestoreì— ì—…ë°ì´íŠ¸
            
            // ë¡œì»¬ ì´ˆê¸°í™”
            showNotification(`${studentName.trim()}ë‹˜ì˜ ìë¦¬ê°€ ë°°ì •ë˜ì—ˆìŠµë‹ˆë‹¤!`, 'success');
            setStudentName('');
            setSelectedSeat(null);
          };

          const getTotalOccupied = () => {
            return Object.values(seats).reduce((sum, section) => {
              return sum + section.filter(seat => seat !== null).length;
            }, 0);
          };

          const getSeatNumber = (section, index) => {
            // 1ë¶„ë‹¨: 1~8, 2ë¶„ë‹¨: 9~16, 3ë¶„ë‹¨: 17~25, 4ë¶„ë‹¨: 26~31
            if (section === 'section1') return index + 1;
            if (section === 'section2') return index + 9;
            if (section === 'section3') return index + 17;
            if (section === 'section4') return index + 26;
          };

          const renderSeat = (section, index, student) => {
            const isOccupied = student !== null;
            const isSelected = selectedSeat?.section === section && selectedSeat?.index === index;
            const isDisabled = !isStarted && !isAdminMode;
            
            return (
              <button
                key={index}
                onClick={() => handleSeatSelect(section, index)}
                disabled={(isOccupied && !isAdminMode) || isDisabled || isLoading}
                className={`
                  w-24 h-24 rounded-xl border-2 flex items-center justify-center text-sm font-medium
                  transition-all duration-200 shadow-md
                  ${isLoading
                    ? 'bg-gray-200 border-gray-300 cursor-wait text-gray-500'
                    : isDisabled && !isOccupied
                      ? 'bg-gray-100 border-gray-300 cursor-not-allowed text-gray-400'
                      : isOccupied 
                        ? isAdminMode
                          ? 'bg-gray-300 border-gray-400 cursor-pointer text-gray-600 hover:bg-red-300 hover:border-red-400'
                          : 'bg-gray-300 border-gray-400 cursor-not-allowed text-gray-600'
                        : isSelected
                          ? 'bg-blue-500 border-blue-600 text-white shadow-lg scale-105'
                          : 'bg-white border-blue-400 hover:border-blue-600 hover:shadow-lg cursor-pointer'
                  }
                `}
              >
                {isLoading ? (
                  <Loader2 size={24} className="animate-spin text-gray-500" />
                ) : isOccupied ? (
                  <div className="flex flex-col items-center gap-1">
                    <User size={18} />
                    <span className="text-xs font-bold truncate max-w-[80%]">{student}</span>
                  </div>
                ) : isSelected ? (
                  <Check size={24} />
                ) : (
                  <span className="text-gray-500 font-bold text-xl">{getSeatNumber(section, index)}</span>
                )}
              </button>
            );
          };

          const renderSection = (sectionKey, sectionNum) => {
            const sectionSeats = seats[sectionKey];
            let rows = [];
            
            // ì„¹ì…˜ë³„ ìë¦¬ ë Œë”ë§ ë¡œì§ (ê¸°ì¡´ê³¼ ë™ì¼)
            if (sectionNum === 1 || sectionNum === 2) {
              for (let i = 0; i < 4; i++) {
                const rowSeats = [];
                for (let j = 0; j < 2; j++) {
                  const idx = i * 2 + j;
                  rowSeats.push(renderSeat(sectionKey, idx, sectionSeats[idx]));
                }
                rows.push(<div key={i} className="flex gap-4 justify-center">{rowSeats}</div>);
              }
            } else if (sectionNum === 3) {
              for (let i = 0; i < 3; i++) {
                const rowSeats = [];
                for (let j = 0; j < 2; j++) {
                  const idx = i * 2 + j;
                  rowSeats.push(renderSeat(sectionKey, idx, sectionSeats[idx]));
                }
                rows.push(<div key={i} className="flex gap-4 justify-center">{rowSeats}</div>);
              }
              const lastRowSeats = [];
              for (let j = 6; j < 9; j++) {
                lastRowSeats.push(renderSeat(sectionKey, j, sectionSeats[j]));
              }
              rows.push(<div key={3} className="flex gap-4 justify-center">{lastRowSeats}</div>);
            } else if (sectionNum === 4) {
              for (let i = 0; i < 3; i++) {
                const rowSeats = [];
                for (let j = 0; j < 2; j++) {
                  const idx = i * 2 + j;
                  rowSeats.push(renderSeat(sectionKey, idx, sectionSeats[idx]));
                }
                rows.push(<div key={i} className="flex gap-4 justify-center">{rowSeats}</div>);
              }
            }

            return (
              <div className="flex flex-col gap-4">
                {sectionNum === 1 ? (
                  <div className="text-center mb-2">
                    <div className="inline-block bg-amber-100 border-2 border-amber-500 rounded-lg px-6 py-3 font-bold text-amber-800 shadow-md">
                      ğŸª‘ êµíƒ
                    </div>
                  </div>
                ) : (
                  <div className="mb-2 h-12"></div>
                )}
                {rows}
              </div>
            );
          };

          // --- Main Render ---

          if (isLoading) {
            return (
              <div className="min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100">
                <Loader2 className="h-10 w-10 text-blue-600 animate-spin" />
                <p className="mt-4 text-lg text-blue-800 font-semibold">ë°ì´í„°ë¥¼ ë¡œë”© ì¤‘ì…ë‹ˆë‹¤...</p>
                <p className="mt-2 text-sm text-gray-500">ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”.</p>
              </div>
            );
          }

          return (
            <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-6 font-inter">
              <NotificationBar notification={notification} setNotification={setNotification} />

              {/* ì´ˆê¸°í™” í™•ì¸ ëª¨ë‹¬ */}
                {showResetConfirm && (
                    <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                        <div className="bg-white p-8 rounded-xl shadow-2xl max-w-sm w-full text-center">
                            <p className="text-xl font-bold text-red-600 mb-4">ğŸš¨ ë°ì´í„° ì´ˆê¸°í™” ê²½ê³ </p>
                            <p className="text-gray-700 mb-6">
                                ì •ë§ë¡œ ëª¨ë“  ìë¦¬ ë°°ì • ë°ì´í„°ì™€ í‹°ì¼“íŒ… ìƒíƒœë¥¼ **ì´ˆê¸°í™”**í•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
                            </p>
                            <div className="flex justify-center gap-4">
                                <button
                                    onClick={confirmReset}
                                    className="px-6 py-3 bg-red-500 text-white rounded-lg font-bold hover:bg-red-600 shadow-md transition-colors"
                                >
                                    ì˜ˆ, ì´ˆê¸°í™”í•©ë‹ˆë‹¤
                                </button>
                                <button
                                    onClick={cancelReset}
                                    className="px-6 py-3 bg-gray-300 text-gray-700 rounded-lg font-bold hover:bg-gray-400 shadow-md transition-colors"
                                >
                                    ì·¨ì†Œ
                                </button>
                            </div>
                        </div>
                    </div>
                )}


              <div className="max-w-7xl mx-auto">
                {/* ì ‘ì†ì ì •ë³´ í‘œì‹œ (ë‹¤ì¤‘ ì‚¬ìš©ì ì•± í•„ìˆ˜ ì¡°ê±´) */}
                <div className="text-right text-xs text-gray-500 mb-2">
                  í˜„ì¬ ì ‘ì† ID: <span className="font-mono font-bold text-gray-700">{userId}</span>
                </div>
                
                <div className="bg-white rounded-3xl shadow-2xl p-8 mb-8">
                  <div className="flex items-center justify-between mb-6">
                    <h1 className="text-3xl font-extrabold text-gray-800 flex items-center gap-3">
                      <Users className="text-blue-600 w-8 h-8" />
                      1í•™ë…„ 6ë°˜ ìë¦¬ í‹°ì¼“íŒ…
                    </h1>
                    <div className="flex items-center gap-3">
                      {showPasswordInput && !isAdminMode ? (
                        <>
                          <input
                            type="password"
                            value={passwordInput}
                            onChange={(e) => setPasswordInput(e.target.value)}
                            onKeyPress={(e) => e.key === 'Enter' && checkPassword()}
                            placeholder="ë¹„ë°€ë²ˆí˜¸"
                            className="px-3 py-2 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none w-32"
                            autoFocus
                          />
                          <button
                            onClick={checkPassword}
                            className="px-3 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 font-medium shadow-md"
                          >
                            í™•ì¸
                          </button>
                          <button
                            onClick={() => {
                              setShowPasswordInput(false);
                              setPasswordInput('');
                            }}
                            className="px-3 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 font-medium"
                          >
                            ì·¨ì†Œ
                          </button>
                        </>
                      ) : (
                        <button
                          onClick={toggleAdminMode}
                          className={`px-4 py-2 rounded-xl text-sm font-bold flex items-center gap-2 transition-colors shadow-lg ${
                            isAdminMode 
                              ? 'bg-red-500 text-white hover:bg-red-600' 
                              : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
                          }`}
                        >
                          {isAdminMode ? <ShieldOff size={18} /> : <Shield size={18} />}
                          {isAdminMode ? 'ê´€ë¦¬ì ëª¨ë“œ (ON)' : 'ê´€ë¦¬ì'}
                        </button>
                      )}
                    </div>
                  </div>
                  <p className="text-center text-gray-600 mb-8">
                    ììœ ë¡­ê²Œ ì›í•˜ëŠ” ìë¦¬ë¥¼ ì„ íƒí•˜ê³  í™•ì •í•˜ì„¸ìš”. ëª¨ë“  ë³€ê²½ ì‚¬í•­ì€ ì‹¤ì‹œê°„ìœ¼ë¡œ ë°˜ì˜ë©ë‹ˆë‹¤.
                  </p>

                  {/* í˜„í™© ë° ì‹œì‘ ìƒíƒœ */}
                  <div className="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                    <div className="p-4 bg-blue-50 rounded-xl shadow-inner border border-blue-200 text-center">
                      <div className="text-2xl font-bold text-blue-700">
                        {getTotalOccupied()} / {TOTAL_SEATS}ëª…
                      </div>
                      <div className="text-sm text-blue-600 mt-1 font-medium">ë°°ì • í˜„í™©</div>
                    </div>
                    <div className="p-4 bg-green-50 rounded-xl shadow-inner border border-green-200 text-center">
                      <div className="text-2xl font-bold text-green-700">
                        {TOTAL_SEATS - getTotalOccupied()}ê°œ
                      </div>
                      <div className="text-sm text-green-600 mt-1 font-medium">ë‚¨ì€ ìë¦¬</div>
                    </div>

                    {isAdminMode ? (
                        <div className="p-4 bg-yellow-50 border-2 border-yellow-300 rounded-xl shadow-inner">
                            <div className="flex flex-col h-full justify-between">
                                <span className="font-medium text-gray-700 mb-2">
                                    í‹°ì¼“íŒ… ìƒíƒœ: <span className={`font-bold ${isStarted ? 'text-green-600' : 'text-red-600'}`}>{isStarted ? 'ì§„í–‰ ì¤‘ ğŸŸ¢' : 'ëŒ€ê¸° ì¤‘ ğŸ”´'}</span>
                                </span>
                                <div className="flex gap-2">
                                     <button
                                        onClick={toggleSeatingStart}
                                        className={`flex-1 py-2 rounded-lg font-bold transition-colors shadow-md text-white ${
                                            isStarted
                                                ? 'bg-red-500 hover:bg-red-600'
                                                : 'bg-green-500 hover:bg-green-600'
                                        }`}
                                    >
                                        {isStarted ? 'ì¤‘ì§€' : 'ì‹œì‘'}
                                    </button>
                                     <button
                                        onClick={resetData}
                                        className="w-1/3 py-2 bg-gray-400 text-white rounded-lg font-bold hover:bg-gray-500 shadow-md transition-colors flex items-center justify-center gap-1"
                                    >
                                        <RotateCcw size={18} /> ì´ˆê¸°í™”
                                    </button>
                                </div>
                            </div>
                        </div>
                    ) : (
                        <div className={`p-4 rounded-xl shadow-inner text-center ${isStarted ? 'bg-green-100 border border-green-300' : 'bg-red-100 border border-red-300'}`}>
                            <p className={`font-bold text-xl ${isStarted ? 'text-green-800' : 'text-red-800'}`}>
                                {isStarted ? 'âœ… í‹°ì¼“íŒ… ì§„í–‰ ì¤‘' : 'â¸ï¸ í‹°ì¼“íŒ… ëŒ€ê¸° ì¤‘'}
                            </p>
                            <p className="text-sm text-gray-600 mt-1">
                                {isStarted ? 'ì›í•˜ëŠ” ìë¦¬ë¥¼ ì„ íƒí•˜ì„¸ìš”.' : 'ì„ ìƒë‹˜ì˜ ì‹œì‘ì„ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”.'}
                            </p>
                        </div>
                    )}
                  </div>

                  {/* í•™ìƒ ì´ë¦„ ì…ë ¥ & ìë¦¬ ì„ íƒ */}
                  <div className="p-6 bg-gray-50 rounded-2xl shadow-inner">
                    <div className="grid grid-cols-1 md:grid-cols-3 gap-6 items-end">
                        <div className="md:col-span-1">
                            <label className="block text-sm font-medium text-gray-700 mb-2">
                                í•™ìƒ ì´ë¦„
                            </label>
                            <input
                                type="text"
                                value={studentName}
                                onChange={(e) => setStudentName(e.target.value)}
                                placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”"
                                className="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none text-lg transition-colors"
                                disabled={!isStarted && !isAdminMode}
                            />
                        </div>

                        <div className="md:col-span-1 text-center">
                            {selectedSeat ? (
                                <div className="p-3 bg-blue-100 rounded-lg border border-blue-300">
                                    <span className="text-blue-700 font-bold text-lg">
                                        ì„ íƒí•œ ìë¦¬: {selectedSeat.section.replace('section', '')}ë¶„ë‹¨ {getSeatNumber(selectedSeat.section, selectedSeat.index)}ë²ˆ
                                    </span>
                                </div>
                            ) : (
                                <div className="p-3 bg-gray-100 rounded-lg border border-gray-300 text-gray-500 font-medium">
                                    ìë¦¬ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”
                                </div>
                            )}
                        </div>
                        
                        <div className="md:col-span-1">
                            <button
                                onClick={confirmSeat}
                                disabled={!studentName.trim() || !selectedSeat || !isStarted}
                                className="w-full bg-gradient-to-r from-blue-600 to-indigo-600 text-white py-3 rounded-lg font-bold text-lg hover:from-blue-700 hover:to-indigo-700 disabled:from-gray-400 disabled:to-gray-500 disabled:cursor-not-allowed shadow-xl transition-all duration-200 transform hover:scale-[1.01]"
                            >
                                ìë¦¬ í™•ì •í•˜ê¸°
                            </button>
                        </div>
                    </div>
                  </div>
                </div>

                {/* ìë¦¬ ë°°ì¹˜ë„ */}
                <div className="bg-white rounded-3xl shadow-2xl p-8">
                  <h2 className="text-2xl font-bold text-center mb-6 text-gray-800">
                    ğŸª‘ ì‹¤ì‹œê°„ êµì‹¤ ë°°ì¹˜ë„
                  </h2>

                  {/* ì·¨ì†Œ í™•ì¸ì°½ (ê´€ë¦¬ì ëª¨ë“œì—ì„œë§Œ í‘œì‹œ) */}
                  {cancelTarget && (
                    <div className="mb-6 p-4 bg-red-50 border-2 border-red-300 rounded-xl text-center shadow-md">
                      <p className="text-center text-red-700 font-bold mb-4 text-lg">
                        ì •ë§ë¡œ <span className="text-red-900">{cancelTarget.name}</span>ë‹˜ì˜ ìë¦¬ë¥¼ ì·¨ì†Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?
                      </p>
                      <div className="flex justify-center gap-4">
                        <button
                          onClick={confirmCancel}
                          className="px-6 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 font-bold shadow-lg transition-colors"
                        >
                          ì˜ˆ, ì·¨ì†Œí•©ë‹ˆë‹¤
                        </button>
                        <button
                          onClick={cancelCancel}
                          className="px-6 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 font-bold transition-colors"
                        >
                          ì•„ë‹ˆì˜¤
                        </button>
                      </div>
                    </div>
                  )}

                  <div className="mb-8 flex justify-center gap-6 text-sm p-4 bg-gray-100 rounded-lg">
                    <div className="flex items-center gap-2">
                      <div className="w-4 h-4 bg-white border-2 border-blue-400 rounded-full"></div>
                      <span className="font-medium text-gray-700">ë¹ˆ ìë¦¬</span>
                    </div>
                    <div className="flex items-center gap-2">
                      <div className="w-4 h-4 bg-blue-500 border-2 border-blue-600 rounded-full"></div>
                      <span className="font-medium text-gray-700">ì„ íƒ ì¤‘</span>
                    </div>
                    <div className="flex items-center gap-2">
                      <div className="w-4 h-4 bg-gray-300 border-2 border-gray-400 rounded-full"></div>
                      <span className="font-medium text-gray-700">ë°°ì • ì™„ë£Œ</span>
                    </div>
                  </div>

                  <div className="grid grid-cols-4 gap-10">
                    {renderSection('section1', 1)}
                    {renderSection('section2', 2)}
                    {renderSection('section3', 3)}
                    {renderSection('section4', 4)}
                  </div>
                </div>
              </div>
            </div>
          );
        }
        
        // React Appì„ ë Œë”ë§í•©ë‹ˆë‹¤.
        ReactDOM.render(<ClassroomSeatingApp />, document.getElementById('root'));
    </script>
</body>
</html>